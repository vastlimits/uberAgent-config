
#
# The rules are generated from the Sigma GitHub repository at https://github.com/SigmaHQ/sigma
# To generate the ruleset, please follow the instructions provided in the repository: https://github.com/vastlimits/pySigma-backend-uberAgent/
#
# The command used to generate the ruleset is:
#    sigma convert -s -f conf -p uberagent-6.2.0 -O backend_version=main -t uberagent /home/runner/work/uberAgent-config/uberAgent-config/build/sigma-informational >> uberAgent-ESA-am-sigma-informational.conf
#

[ActivityMonitoringRule]
# Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network
# Author: frack113
RuleName = Suspicious Tasklist Discovery Command
EventType = Process.Start
Tag = proc-start-suspicious-tasklist-discovery-command
RiskScore = 1
Query = Process.CommandLine like r"%tasklist%" or Process.Path like r"%\\tasklist.exe" or Process.Name == "tasklist.exe"


[ActivityMonitoringRule]
# Detect DLL Load from Spooler Service backup folder
# Author: FPT.EagleEye, Thomas Patzke (improvements)
RuleName = Windows Spooler Service Suspicious Binary Load
EventType = Image.Load
Tag = windows-spooler-service-suspicious-binary-load
RiskScore = 1
Query = Process.Path like r"%\\spoolsv.exe" and (Image.Path like r"%\\Windows\\System32\\spool\\drivers\\x64\\3\\%" or Image.Path like r"%\\Windows\\System32\\spool\\drivers\\x64\\4\\%") and Image.Path like r"%.dll"
GenericProperty1 = Image.Path

