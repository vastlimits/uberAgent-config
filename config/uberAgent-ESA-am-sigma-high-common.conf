
#
# The rules are generated from the Sigma GitHub repository at https://github.com/SigmaHQ/sigma
# To generate the ruleset, please follow the instructions provided in the repository: https://github.com/vastlimits/pySigma-backend-uberAgent/
#
# The command used to generate the ruleset is:
#    sigma convert -s -f conf -p uberagent-develop -t uberagent /home/runner/work/uberAgent-config/uberAgent-config/build/sigma-high-common >> uberAgent-ESA-am-sigma-high-common.conf
#

[ActivityMonitoringRule]
# Detects communication to C2 servers mentioned in the operational notes of the ShadowBroker leak of EquationGroup C2 tools
# Author: Florian Roth (Nextron Systems)
RuleId = 881834a4-6659-4773-821e-1c151789d873
RuleName = Equation Group C2 Communication
EventType = Net.Any
Tag = equation-group-c2-communication
RiskScore = 75
Annotation = {"mitre_attack": ["T1041"]}
Query = Net.Target.Ip in ["69.42.98.86", "89.185.234.145"] or Net.Source.Ip in ["69.42.98.86", "89.185.234.145"]
GenericProperty1 = Net.Target.Ip
GenericProperty2 = Net.Source.Ip

