
#
# The rules are generated from the Sigma GitHub repository at https://github.com/SigmaHQ/sigma
# To generate the ruleset, please follow the instructions provided in the repository: https://github.com/vastlimits/pySigma-backend-uberAgent/
#
# The command used to generate the ruleset is:
#    sigma convert -s -f conf -p uberagent-7.5.0 -O backend_version=7.5.0 -t uberagent /home/runner/work/uberAgent-config/uberAgent-config/build/sigma-informational-windows >> uberAgent-ESA-am-sigma-informational-windows.conf
#

[ThreatDetectionRule platform=Windows]
# A General detection for a new application in AppCompat. This indicates an application executing for the first time on an endpoint.
# Author: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)
RuleId = 60936b49-fca0-4f32-993d-7415edcf9a5d
RuleName = New Application in AppCompat
EventType = Reg.Any
Tag = new-application-in-appcompat
RiskScore = 1
Annotation = {"mitre_attack": ["T1204.002"], "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)"}
Query = Reg.TargetObject like r"%\\AppCompatFlags\\Compatibility Assistant\\Store\\%"
Hive = HKLM,HKU
GenericProperty1 = Reg.TargetObject


[ThreatDetectionRule platform=Windows]
# Detect DLL Load from Spooler Service backup folder
# Author: FPT.EagleEye, Thomas Patzke (improvements)
RuleId = 02fb90de-c321-4e63-a6b9-25f4b03dfd14
RuleName = Windows Spooler Service Suspicious Binary Load
EventType = Image.Load
Tag = windows-spooler-service-suspicious-binary-load
RiskScore = 1
Annotation = {"mitre_attack": ["T1574"], "author": "FPT.EagleEye, Thomas Patzke (improvements)"}
Query = Process.Path like r"%\\spoolsv.exe" and (Image.Path like r"%\\Windows\\System32\\spool\\drivers\\x64\\3\\%" or Image.Path like r"%\\Windows\\System32\\spool\\drivers\\x64\\4\\%") and Image.Path like r"%.dll"
GenericProperty1 = Image.Path

