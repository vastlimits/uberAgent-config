
#
# The rules are generated from the Sigma GitHub repository at https://github.com/SigmaHQ/sigma
# To generate the ruleset, please follow the instructions provided in the repository: https://github.com/vastlimits/pySigma-backend-uberAgent/
#
# The command used to generate the ruleset is:
#    sigma convert -s -f conf -p uberagent-develop -O backend_version=develop -t uberagent /home/runner/work/uberAgent-config/uberAgent-config/build/sigma-informational-windows >> uberAgent-ESA-am-sigma-informational-windows.conf
#

[ActivityMonitoringRule platform=Windows]
# Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network
# Author: frack113
RuleId = 63332011-f057-496c-ad8d-d2b6afb27f96
RuleName = Suspicious Tasklist Discovery Command
EventType = Process.Start
Tag = proc-start-suspicious-tasklist-discovery-command
RiskScore = 1
Annotation = {"mitre_attack": ["T1057"], "author": "frack113"}
Query = Process.CommandLine like r"%tasklist%" or Process.Path like r"%\\tasklist.exe" or Process.Name == "tasklist.exe"


[ActivityMonitoringRule platform=Windows]
# Detect DLL Load from Spooler Service backup folder
# Author: FPT.EagleEye, Thomas Patzke (improvements)
RuleId = 02fb90de-c321-4e63-a6b9-25f4b03dfd14
RuleName = Windows Spooler Service Suspicious Binary Load
EventType = Image.Load
Tag = windows-spooler-service-suspicious-binary-load
RiskScore = 1
Annotation = {"mitre_attack": ["T1574"], "author": "FPT.EagleEye, Thomas Patzke (improvements)"}
Query = Process.Path like r"%\\spoolsv.exe" and (Image.Path like r"%\\Windows\\System32\\spool\\drivers\\x64\\3\\%" or Image.Path like r"%\\Windows\\System32\\spool\\drivers\\x64\\4\\%") and Image.Path like r"%.dll"
GenericProperty1 = Image.Path


[ActivityMonitoringRule platform=Windows]
# A General detection for a new application in AppCompat. This indicates an application executing for the first time on an endpoint.
# Author: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)
RuleId = 60936b49-fca0-4f32-993d-7415edcf9a5d
RuleName = New Application in AppCompat
EventType = Reg.Any
Tag = new-application-in-appcompat
RiskScore = 1
Annotation = {"mitre_attack": ["T1204.002"], "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)"}
Query = Reg.TargetObject like r"%\\AppCompatFlags\\Compatibility Assistant\\Store\\%"
Hive = HKLM,HKU
GenericProperty1 = Reg.TargetObject

