#
# This is the configuration file for uberAgent that contains the ESA security inventory includes
# It is only required if uberAgent ESA is enabled.
# Place it in the same directory as uberAgent.exe.
#

############################################
# Security inventory timer
############################################

[Timer]
Name              = Modular security inventory timer
Interval          = 86400000
Start delay       = 600000
Persist interval  = true
UA metric         = SecurityInventory.Antivirus
UA metric         = SecurityInventory.Firewall
UA metric         = SecurityInventory.LocalUsersAndGroups
UA metric         = SecurityInventory.Network
UA metric         = SecurityInventory.PowerShell
UA metric         = SecurityInventory.Service
UA metric         = SecurityInventory.WindowsConfiguration

[Timer]
Name              = Modular security inventory timer for Certificate
Interval          = 86400000
Start delay       = 600000
Persist interval  = true
UA metric         = SecurityInventory.Certificate

############################################
#
# Security inventory scripts
#
############################################

[ScriptInterpreter]
Name = PowerShell
Executable = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
Parameter = -ExecutionPolicy Bypass -file ###UA_SCRIPT###

[SecurityInventoryTest]
Name = Antivirus
ScriptId = 01270F6B-7160-4629-90C4-F36E621D43E1
Category = Antivirus
ScriptTimeoutMs = 600000
ScriptCommandline = "###UA_SI_LOCALPATH###\Antivirus\Antivirus.ps1"
Interpreter = PowerShell
OutputFormat = JSON
ScriptContext = Session0AsSystem
SecurityLevel = Medium + AllowChildProcesses=2

[SecurityInventoryTest]
Name = Certificate-Machine
ScriptId = 02270F6B-7160-4629-90C4-F36E621D43E2
Category = Certificate
ScriptTimeoutMs = 600000
ScriptCommandline = "###UA_SI_LOCALPATH###\Certificate\Certificate-Machine.ps1"
Interpreter = PowerShell
OutputFormat = JSON
ScriptContext = Session0AsSystem
SecurityLevel = Low

[SecurityInventoryTest]
Name = Certificate-User
ScriptId = 03270F6B-7160-4629-90C4-F36E621D43C2
Category = Certificate
ScriptTimeoutMs = 600000
ScriptCommandline = "###UA_SI_LOCALPATH###\Certificate\Certificate-User.ps1"
Interpreter = PowerShell
OutputFormat = JSON
ScriptContext = UserSessionAsUser
SecurityLevel = Medium + AllowChildProcesses=3

[SecurityInventoryTest]
Name = Firewall
ScriptId = 04270F6B-7160-4629-90C4-F36E621D43E3
Category = Firewall
ScriptTimeoutMs = 600000
ScriptCommandline = "###UA_SI_LOCALPATH###\Firewall\Firewall.ps1"
Interpreter = PowerShell
OutputFormat = JSON
ScriptContext = Session0AsSystem
SecurityLevel = Medium + AllowChildProcesses=2

[SecurityInventoryTest]
Name = LocalUsersAndGroups-Machine
ScriptId = 05270F6B-7160-4629-90C4-F36E621D43E4
Category = LocalUsersAndGroups
ScriptTimeoutMs = 600000
ScriptCommandline = "###UA_SI_LOCALPATH###\LocalUserAndGroups\LocalUsersAndGroups-Machine.ps1"
Interpreter = PowerShell
OutputFormat = JSON
ScriptContext = Session0AsSystem
SecurityLevel = Medium + AllowChildProcesses=2

[SecurityInventoryTest]
Name = LocalUsersAndGroups-User
ScriptId = 06270F6B-7160-4629-90C4-F36E621D43E5
Category = LocalUsersAndGroups
ScriptTimeoutMs = 600000
ScriptCommandline = "###UA_SI_LOCALPATH###\LocalUserAndGroups\LocalUsersAndGroups-User.ps1"
Interpreter = PowerShell
OutputFormat = JSON
ScriptContext = UserSessionAsUser
SecurityLevel = Medium + AllowChildProcesses=2

[SecurityInventoryTest]
Name = Network-Machine
ScriptId = 07270F6B-7160-4629-90C4-F36E621D43E6
Category = Network
ScriptTimeoutMs = 600000
ScriptCommandline = "###UA_SI_LOCALPATH###\Network\NetworkConfiguration-Machine.ps1"
Interpreter = PowerShell
OutputFormat = JSON
ScriptContext = Session0AsSystem
SecurityLevel = Medium + AllowChildProcesses=2

[SecurityInventoryTest]
Name = Network-User
ScriptId = 08270F6B-7160-4629-90C4-F36E621D43F1
Category = Network
ScriptTimeoutMs = 600000
ScriptCommandline = "###UA_SI_LOCALPATH###\Network\NetworkConfiguration-User.ps1"
Interpreter = PowerShell
OutputFormat = JSON
ScriptContext = UserSessionAsUser
SecurityLevel = Medium + AllowChildProcesses=2

[SecurityInventoryTest]
Name = PowerShell-Machine
ScriptId = 09270F6B-7160-4629-90C4-F36E621D43E7
Category = PowerShell
ScriptTimeoutMs = 600000
ScriptCommandline = "###UA_SI_LOCALPATH###\PowerShell\PowerShell-Machine.ps1"
Interpreter = PowerShell
OutputFormat = JSON
ScriptContext = Session0AsSystem
SecurityLevel = Medium + AllowChildProcesses=2

[SecurityInventoryTest]
Name = PowerShell-User
ScriptId = 10270F6B-7160-4629-90C4-F36E621D41A7
Category = PowerShell
ScriptTimeoutMs = 600000
ScriptCommandline = "###UA_SI_LOCALPATH###\PowerShell\PowerShell-User.ps1"
Interpreter = PowerShell
OutputFormat = JSON
ScriptContext = UserSessionAsUser
SecurityLevel = Medium + AllowChildProcesses=2

[SecurityInventoryTest]
Name = Service
ScriptId = 11270F6B-7160-4629-90C4-F36E621D43E8
Category = Service
ScriptTimeoutMs = 600000
ScriptCommandline = "###UA_SI_LOCALPATH###\Service\WindowsServices.ps1"
Interpreter = PowerShell
OutputFormat = JSON
ScriptContext = Session0AsSystem
SecurityLevel = Medium + AllowChildProcesses=3

[SecurityInventoryTest]
Name = WindowsConfiguration-Machine
ScriptId = 12270F6B-7160-4629-90C4-F36E621D43E9
Category = WindowsConfiguration
ScriptTimeoutMs = 600000
ScriptCommandline = "###UA_SI_LOCALPATH###\WindowsConfiguration\WindowsConfiguration-Machine.ps1"
Interpreter = PowerShell
OutputFormat = JSON
ScriptContext = Session0AsSystem
SecurityLevel = Medium + AllowChildProcesses=3

[SecurityInventoryTest]
Name = WindowsConfiguration-User
ScriptId = 13270F6B-7160-4629-90C4-F36E621D43F9
Category = WindowsConfiguration
ScriptTimeoutMs = 600000
ScriptCommandline = "###UA_SI_LOCALPATH###\WindowsConfiguration\WindowsConfiguration-User.ps1"
Interpreter = PowerShell
OutputFormat = JSON
ScriptContext = UserSessionAsUser
SecurityLevel = Medium + AllowChildProcesses=3

